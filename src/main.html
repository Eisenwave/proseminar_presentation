<meta charset="UTF-8">
<html lang="de_de">
<head>
    <title></title>
    <meta content="">

    <style>
        html {
            scroll-behavior: smooth;
        }

        body {
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        ol {
            counter-reset: item;
            padding-left: 20px;
        }

        li {
            display: block;
        }

        li:before {
            content: counters(item, ".") ". ";
            counter-increment: item;
            font-family: serif;
            font-weight: bold;
        }

        .li0:before {
            content: "\FFED  ";
        }

        .li1 {
            padding-top: 4px;
            padding-bottom: 4px;
        }

        .li2 {
            padding-top: 2px;
            padding-bottom: 2px;
        }

        h1 {
            font-family: sans-serif;
            text-decoration: underline
        }

        h2 {
            font-family: sans-serif;
            font-weight: bold;
        }

        h3 {
            font-family: sans-serif;
            font-weight: bold;
        }

        h4 {
            font-family: sans-serif;
            font-weight: bold;
        }

        section {
            margin-bottom: 100%;
            margin-top: 100%;
            min-height: 400px;
            background-image: linear-gradient(to bottom, white, rgb(250, 250, 250), rgb(245, 245, 245), rgb(250, 250, 250), white);
        }

        .MathJax:focus, .mjx-chtml:focus, .MathJax_SVG:focus {
            outline: 0 solid gray;
        }
    </style>

    <script src='js/mathjax/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

</head>
<body>

<section style="margin-top: 0">
    <h1 id="heading-top">Pseudozufallsfolgengeneratoren</h1>
</section>

<section>
    <h2>Einführung (1 min)</h2>
    <ul>
        <li class="li0">Zufallsgeneratoren sind überall.</li>
        <li class="li0">... und zwar seit sehr langer Zeit</li>
    </ul>
</section>


<section>
    <h2 id="heading-inhaltsverzeichnis">Inhaltsverzeichnis (1 min)</h2>

    <ol>
        <li class="li1">
            <a href="#heading-definitionen">Definitionen (1 min)</a>
        </li>


        <li class="li1">
            <a href="#heading-middle-square">Mittquadratmethode (7.5 min)</a>
            <ol>
                <li class="li2">Geschichte und Anwendung</li>
                <li class="li2"><a href="#heading-ms-funktionsweise">Funktionsweise</a></li>
                <li class="li2"><a href="#heading-ms-bewertungskriterien">
                    Bewertungskriterien von PZGs anhand der
                    Middle-Square-Methode</a>
                    <ol>
                        <li>Effizienz</li>
                        <li>Werteverteilungen</li>
                        <li>Periodenlänge</li>
                        <li>LSB-Analyse</li>
                        <li><a href="#heading-ms-2d">Zeichnen der Generatorfunktion</a></li>
                        <li><a href="#heading-ms-3d">3D-Darstellung</a></li>
                        <li>Stochastische Tests</li>
                    </ol>
                </li>
            </ol>
        </li>


        <li class="li1">
            <a href="#heading-kg">Kongruenzgeneratoren</a>
            <ol>
                <li class="li2"><a href="#heading-kg-funktionsweise">Funktionsweise</a></li>
                <li class="li2"><a href="#heading-randu">RANDU (Multiplikative Kongruenzgeneratoren)</a>
                    <ol>
                        <li>Geschichte und Anwendung</li>
                        <li>Bewertung</li>
                    </ol>
                </li>
                <li class="li2"><a href="#heading-lkg">Lineare Kongruenzgeneratoren</a>
                    <ol>
                        <li>Geschichte und Anwendung</li>
                        <li>Bewertung</li>
                    </ol>
                </li>
                <!--li class="li2">
                    Weitere Kongruenzgeneratoren
                    <ol>
                        <li>Fibonacci-Generatoren</li>
                    </ol>
                </li-->
            </ol>
        </li>

        <li class="li1">
            <a href="#heading-modern">Moderne Verfahren</a>
            <ol>
                <li class="li2"><a href="#heading-zuverlaessig">Zuverlässige PZGs</a></li>
                <li class="li2"><a href="#heading-krypto">Kryptographisch sichere PZGs</a></li>
            </ol>
        </li>

        <li class="li1">Schluss</li>

        <li class="li1">
            <a href="#heading-quellen">Quellenverzeichnis</a>
            <ol>
                <li>Bildquellen, Visualisierung</li>
                <li>Literaturverzeichnis</li>
            </ol>
        </li>
    </ol>
</section>


<section>
    <h2 id="heading-definitionen">1. Definitionen</h2>
</section>


<section>
    <h2 id="heading-middle-square">2. Middle-Square-Methode</h2>
    <script src="js/MiddleSquareCalc.js"></script>
    <script src="js/RanduCalc.js"></script>

    <h3 id="heading-ms-funktionsweise">2.1. Funktionsweise</h3>
    <div style="text-align: center; width: 800px">
        \[X_{i+1} = \Bigl\lfloor\dfrac{X_i^2}{100}\Bigr\rfloor \mod 10^5\]
        <p>
            Der aktuelle vier-stellige Zustand \(X_i\) wird quadriert und anschließend werden die 4 mittleren Stellen
            des 8-stelligen Zwischenergebnises "ausgeschnitten".
        </p>
    </div>

    <table>
        <tr>
            <td>\(X_i\)</td>
            <td>
                <input id="in" style="font-family: monospace" min="0" max="9999" type="number"
                       oninput="onMiddleSquareInput(MS_IN, MS_OUT, MS_SQR)"/>
            </td>

        </tr>
        <tr>
            <td>\(X_i^2\)</td>
            <td>
                <textarea id="in_squared" rows="1" cols="8" readonly></textarea>
            </td>
        </tr>
        <tr>
            <td>\(X_{i+1}\)</td>
            <td>
                <textarea id="out" rows="1" cols="8" readonly></textarea>
            </td>
        </tr>
        <tr>

            <td>
                <button id="ms-button"
                        onclick="onMiddleSquareButton(MS_IN, MS_OUT, MS_SQR)">
                    \(X_i = X_{i+1}\)
                </button>
            </td>
            <td>
                <button style="font-family: sans-serif; font-weight: bold"
                        onclick="turbo(MS_BUTTON, 50, 50)">
                    50x
                </button>
            </td>
        </tr>
    </table>
</section>


<section>
    <h3 id="heading-ms-bewertungskriterien">2.2. Bewertungskriterien von PZG anhand der Middle-Square-Methode</h3>
</section>

<section>
    <h4 id="heading-ms-verteilung">2.3.1 Middle-Square-Methode Verteilung</h4>
    <canvas id="canvas-ms-dist" width="730" height="550" style="border:1px solid #000000;"></canvas>
    <script>
        {
            let c = document.getElementById("canvas-ms-dist");
            let context = c.getContext("2d");

            const WIDTH = 730;
            const HEIGHT = 550;
            const STEP = 10000 / WIDTH;

            let histogram = new Int16Array(WIDTH);
            for (let i = 0; i < 10000; i++) {
                let val = middleSquare4(i);
                //console.log(histogram[Math.floor(val / STEP)] + " -> " + histogram[Math.floor(val / STEP)]++);
                histogram[Math.floor(val / STEP)]++;
            }
            const SCALE = HEIGHT / Math.max.apply(null, histogram);

            context.fillStyle = "Red";

            for (let i = 0; i < WIDTH; i++) {
                let y = Math.floor(histogram[i] * SCALE);
                context.fillRect(i, HEIGHT - y, 1, y);
            }
        }
    </script>
</section>

<section>
    <h4 id="heading-randu-verteilung">2.3.1 RANDU Verteilung</h4>
    <canvas id="canvas-randu-dist" width="730" height="550" style="border:1px solid #000000;"></canvas>
    <script>
        {
            let c = document.getElementById("canvas-randu-dist");
            let context = c.getContext("2d");

            const WIDTH = 730;
            const HEIGHT = 550;
            const MAX = 2147483648;
            const STEP_COUNT = 10000;
            const STEP_SIZE = MAX / WIDTH;

            let histogram = new Int32Array(WIDTH);
            for (let i = 0; i < STEP_COUNT; i++) {
                let val = randu(i * STEP_SIZE);
                //console.log(histogram[Math.floor(val / STEP)] + " -> " + histogram[Math.floor(val / STEP)]++);
                histogram[Math.floor(val / STEP_SIZE)]++;
            }
            const SCALE = HEIGHT / Math.max.apply(null, histogram);

            context.fillStyle = "Red";

            for (let i = 0; i < WIDTH; i++) {
                let y = Math.floor(histogram[i] * SCALE);
                context.fillRect(i, HEIGHT - y, 1, y);
            }
        }
    </script>
</section>

<section>
    <h4 id="heading-ms-2d">2.3.1 Middle-Square-Methode 2D</h4>
    <canvas id="canvas-ms-2d" width="730" height="550" style="border:1px solid #000000;"></canvas>
    <script>
        {
            let c = document.getElementById("canvas-ms-2d");
            let context = c.getContext("2d");
            const PIX_BUFFER = context.createImageData(1, 1); // only do this once per page
            let d = PIX_BUFFER.data;                        // only do this once per page
            d[0] = 255;
            d[1] = 0;
            d[2] = 0;
            d[3] = 255;

            /*context.moveTo(0, 0);
        context.lineTo(200, 100);
        context.stroke();*/

            const WIDTH = 730;
            const HEIGHT = 550;
            const MAX = 10000;
            const STEP_COUNT = MAX;
            const STEP_SIZE = MAX / STEP_COUNT;
            const SCALE_Y = HEIGHT / MAX;
            const SCALE_X = WIDTH / STEP_COUNT;

            function drawDot(x, y) {
                context.fillRect(x - 1, HEIGHT - 1 - y - 1, 3, 3);
            }

            context.fillStyle = "Red";

            for (let x = 0; x < STEP_COUNT; x++) {
                let y = middleSquare4(Math.floor(x * STEP_SIZE));
                drawDot(Math.floor(x * SCALE_X), Math.floor(y * SCALE_Y));
            }
        }
    </script>
</section>

<section>
    <h4 id="heading-randu-2d">2.3.1 RANDU 2D</h4>
    <canvas id="canvas-randu-2d" width="730" height="500" style="border:1px solid #000000;"></canvas>
    <script>
        {
            let c = document.getElementById("canvas-randu-2d");
            let context = c.getContext("2d");
            const PIX_BUFFER = context.createImageData(1, 1); // only do this once per page
            let d = PIX_BUFFER.data;                        // only do this once per page
            d[0] = 255;
            d[1] = 0;
            d[2] = 0;
            d[3] = 255;

            const WIDTH = 730;
            const HEIGHT = 500;
            const MAX = 2147483648;
            const STEP_COUNT = 5000;
            const STEP_SIZE = MAX / STEP_COUNT;
            const SCALE_Y = HEIGHT / MAX;
            const SCALE_X = WIDTH / STEP_COUNT;

            function drawDot(x, y) {
                //context.putImageData(PIX_BUFFER, x - 1, HEIGHT - 1 - y );
                context.fillRect(x - 1, HEIGHT - 1 - y - 1, 3, 3);
            }

            context.fillStyle = "Red";

            for (let x = 0; x < STEP_COUNT; x++) {
                let y = randu(Math.floor(x * STEP_SIZE));
                drawDot(Math.floor(x * SCALE_X), Math.floor(y * SCALE_Y));
            }
        }
    </script>
</section>

<section>
    <h4 id="heading-ms-3d">2.3.1 Middle-Square-Methode 3D</h4>

    <embed src="middle-square-vis.html"
           style="border: 2px black;"
           width="800" height="600">
</section>


<section>
    <h2 id="heading-kg">3. Kongruenzgeneratoren</h2>

    <h3 id="heading-kg-funktionsweise">3.1. Funktionsweise</h3>

    <div style="width: 800px">
        <h5 style="text-align: center">Allgemeiner Kongruenzgenerator:</h5>
        \[ X_{i+1} = \Biggl(\Bigl(\sum_{k=0}^n a_k X_{i-k}\Bigr) + b\Biggr) \bmod m \]

        <p style="text-align: center">
            Das nächste Element \(X_{i}\) der Folge wird duch Multiplizieren der vorherigen \(X_{i-k}\) mit den
            dazugehörigen konstanten Faktoren \(a_{k}\) und dem Addieren der Konstante \(b\) erzeugt.
        </p>
        <p style="text-align: center">
            Z.B. Fibonacci-Generator: \(a_0 = a_1 = 1,\, b = 0,\, m \in \{0, 1, 2, 3, 5, \ldots\}\)
        </p>

        <h5 style="text-align: center">Linearer Kongruenzgenerator:</h5>
        \[ X_{i+1} = (a \cdot X_{i} + b) \bmod m \]
        <p style="text-align: center">
            Sonderfall für \(a_{k \gt 0} = 0\). Hierbei \(a := a_{0}\).
        </p>

        <h5 style="text-align: center">Multiplikativer Kongruenzgenerator:</h5>
        \[ X_{i+1} = (a \cdot X_{i}) \bmod m \]
        <p style="text-align: center">
            Sonderfall für \(b = 0\)
        </p>

    </div>
</section>


<section>
    <h3 id="heading-randu">3.2. RANDU (Multiplikative Kongruenzgeneratoren)</h3>
    <div style="width:800px">
        \[ \begin{aligned}
        X_{i+1} &= (X_i \cdot 65539) \bmod 2^{31} \\
        &= (X_i \cdot (2^{16}+3) ) \bmod 2^{31} \\
        &= (X_i + X_i + X_i + (X_i \ll 16) ) \mathrel{\&} (2^{31}-1)
        \end{aligned} \]
    </div>

    <table>
        <tr>
            <td>\(X_i\):</td>
            <td>
                <input id="randu-in" style="font-family: monospace" min="0" max="2147483648" type="number"
                       oninput="onRanduInput(RANDU_IN, RANDU_OUT)"/>
            </td>

        </tr>
        <tr>
            <td>\(X_{i+1}\):</td>
            <td>
                <textarea id="randu-out" rows="1" cols="10" readonly></textarea>
            </td>
        </tr>
        <tr>

            <td>
                <button id="randu-button"
                        style="font-family: serif; font-weight: bold" onclick="onRanduButton(RANDU_IN, RANDU_OUT)">
                    \(X_i = X_{i+1}\)
                </button>
            </td>
            <td>
                <button style="font-family: sans-serif; font-weight: bold" onclick="turbo(RANDU_BUTTON, 50, 50)">
                    50x
                </button>
            </td>
        </tr>
    </table>
</section>

<section>
    <h3 id="heading-lkg">3.3. Lineare Kongruenzgeneratoren</h3>
</section>


<section>
    <h2 id="heading-modern">4. Moderne Verfahren</h2>
</section>


<section>
    <h3 id="heading-zuverlaessig">4.1. Zuverlässige Pseudozufallsgeneratoren</h3>
</section>


<section>
    <h3 id="heading-krypto">4.2. Kryptographisch sichere Zufallsgeneratoren</h3>
</section>

<section>
    <h2 id="heading-schluss">5. Schluss</h2>
</section>

<section>
    <h2 id="heading-quellen">6. Quellenverzeichnis</h2>

    <h4 id="heading-bildqullen">6.1. Bildquellen, Visualisierung usw.</h4>
</section>

<section>
    <h4 id="heading-literaturverzeichnis">6.2. Literaturverzeichnis</h4>
</section>

<script>
    // make constants available to buttons and other elements
    const MS_IN = document.getElementById("in");
    const MS_OUT = document.getElementById("out");
    const MS_SQR = document.getElementById("in_squared");
    const MS_BUTTON = document.getElementById("ms-button");
    const RANDU_IN = document.getElementById("randu-in");
    const RANDU_OUT = document.getElementById("randu-out");
    const RANDU_BUTTON = document.getElementById("randu-button");

    let index = 0;
    for (let element of document.querySelectorAll("*")) {
        if (element.tagName === "SECTION")
            element.id = "slide-" + index++;
    }

    function getSlideNumber() {
        // id = "slide-xxx" or some other element
        let id = window.location.hash.substring(1);
        // go up the hierarchy until slide is found
        while (!id.startsWith("slide-")) {
            let element = document.getElementById(id);
            id = element.parentElement.id;
        }

        return parseInt(id.substring(6));
    }

    function jumpSlidesRelative(count) {
        let num = getSlideNumber();
        let id = "slide-" + (num + count);
        if (document.getElementById(id) != null)
            location.hash = "#" + id;
    }

    function onKeyDown(event) {
        switch (event.key) {
            case "ArrowUp":
                event.preventDefault();
                jumpSlidesRelative(-1);
                break;

            case " ":
            case "ArrowDown":
                event.preventDefault();
                jumpSlidesRelative(1);
                break;
        }
    }

    window.addEventListener('keydown', onKeyDown, false);

    if (window.location.hash === "")
        window.location.hash = "slide-0";

    function turbo(button, count, millis) {
        for (let i = 0; i < count; i++) {
            setTimeout(() => {
                button.onclick();
            }, i * millis);
        }
    }
</script>

</body>
</html>
